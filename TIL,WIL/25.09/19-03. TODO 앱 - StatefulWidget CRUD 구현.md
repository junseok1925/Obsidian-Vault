
StatefulWidget에서의 CRUD 예시

Create : `TextFied`에 텍스트 입력 -> `setState()`로 리스트 추가
Read : `ListView.builder`로 리스트 항목 출력
Update : 리스트 항목을 `EditableText`나 다이얼로그로 수정
Delete : 체크박스, 삭제 버튼 등으로 항목 삭제


---
### Create

- todo.dart
```dart
class Todo {
  String title;
  bool isDone;
  Todo({required this.title, required this.isDone});
}
```


- home_page.dart
```dart
import 'package:flutter/material.dart';
import 'package:flutter_todo/todo.dart';
import 'package:flutter_todo/todo_widget.dart';

// 앱실행 시 가장 먼저 보이는 화면 구성
class HomePage extends StatefulWidget {
  @override
  State<HomePage> createState() => _HomePageState();
}

class _HomePageState extends State<HomePage> {
  TextEditingController controller = TextEditingController();

  List<Todo> todoList = []; // textField에서 입력 받은 텍스트를 저장하는 리스트

  void onCreate() {
    setState(() {
      Todo newTodo = Todo(
        title: controller.text,
        isDone: false,
      ); // 체크박스는 기본값이 해제 상태이므로 false
      todoList.add(newTodo);
      controller.clear(); //textField 입력창 클리어
    });
  }

  @override
  void dispose() {
    // 이 위젯이 사라질때 메모리 누수 방지
    super.dispose();
    controller.dispose();
  }

  @override
  Widget build(BuildContext context) {
    return GestureDetector(
      // 키보드가 올라왔을 때 빈공간을 터치하면 키보드가 내려가도록 GestureDetector 위젯으로 감싼 후 onTap 함수 작성
      onTap: () {
        FocusScope.of(context).unfocus();
      },
      child: Scaffold(
        appBar: AppBar(title: Text('TO DO')),
        // 할 일 목록 리스트 생성
        body: ListView.separated(
          //ListView.builde 반복적으로 리스트 생성
          padding: EdgeInsets.only(top: 20, left: 20, right: 20, bottom: 200),
          separatorBuilder: (context, index) => SizedBox(height: 20), // 각 리스트 아이템 사이사이에 들어가게 되서 공간 띄어줌
          itemCount: todoList.length, // 1. 입력되어 보내진 텍스트의 인덱스 갯수가
          itemBuilder: (context, index) {
            // 2. 여기 인덱스로 0,1,2...로 들어감
            Todo todo = todoList[index];
            return TodoWidget(content: todo.title, isDone: todo.isDone);
          },
        ),

        bottomSheet: Container(
          color: Colors.white,
          padding: EdgeInsets.only(top: 20, right: 20, left: 20, bottom: 40),
          child: TextField(
            controller: controller,
            maxLines: 1,
            onSubmitted: (value) {
              // Enter로 텍스트 추가
              onCreate();
            },

            decoration: InputDecoration(
              hintText: "적어",
              border: InputBorder.none,
              fillColor: Colors.blue.withValues(alpha: 0.1),
              filled: true,
              suffixIcon: GestureDetector(
                onTap: () {
                  onCreate();
                },
                child: Container(
                  margin: EdgeInsets.all(10),
                  decoration: BoxDecoration(
                    color: Colors.blue,
                    shape: BoxShape.circle,
                  ),
                  child: Icon(Icons.add, color: Colors.white),
                ),
              ),
              suffixIconConstraints: BoxConstraints(),
            ),
          ),
        ),
      ),
    );
  }
}

```

![[Pasted image 20250920010416.png]]


---

### Read, Update, Delete
```dart
    body: ListView.separated(
          //ListView.builde 반복적으로 리스트 생성
          padding: EdgeInsets.only(top: 20, left: 20, right: 20, bottom: 200),
          separatorBuilder: (context, index) =>
              SizedBox(height: 20), // 각 리스트 아이템 사이사이에 들어가게 되서 공간 띄어줌
          itemCount: todoList.length, // 1. 입력되어 보내진 텍스트의 인덱스 갯수가
          itemBuilder: (context, index) {
            // 2. 여기 인덱스로 0,1,2...로 들어감
            Todo todo = todoList[index];
            return GestureDetector(
              onTap: () {
                setState(() {
                  todo.isDone = !todo.isDone;
                });
              },
              onLongPress: () async {
                print("꾸욱~");
                bool result = await showCupertinoDialog(
                  context: context,
                  barrierDismissible: true, // 팝업창 외 화면 터치하면 팝업창 닫힘
                  builder: (context) {
                    return CupertinoAlertDialog(
                      title: Text("일정을 삭제하시겠습니까?"),
                      actions: [
                        // ios스타일 취소/확인 alert 팝업
                        CupertinoDialogAction(
                          onPressed: () {
                            Navigator.pop(context, false);
                          },
                          child: Text(
                            "취소",
                            style: TextStyle(color: Colors.red),
                          ),
                        ),
                        // ios스타일 취소/확인 alert 팝업
                        CupertinoDialogAction(
                          onPressed: () {
                            Navigator.pop(context, true);
                          },
                          child: Text(
                            "삭제",
                            style: TextStyle(color: Colors.blue),
                          ),
                        ),
                      ],
                    );
                  },
                );

                print(result);
                if (result) {
                  // 삭제버튼을 누른다면
                  // todoeList 리스트 안에 있는 index 요소 삭제
                  print('$index번쪠 todoList요소 삭제함');

                  setState(() {
                    // todoList 요소 삭제 시 화면 다시 build 위해 상태 업데이트
                    todoList.removeAt(index);
                  });
                }
              },
              child: TodoWidget(content: todo.title, isDone: todo.isDone),
            );
          },
        ),
```

- `ListView.separated` 로 `todoList`의 인덱스 순서대로 저장된 텍스트 데이터를 읽어와서 build 하고(Read)

- 체크 박스 위젯인 `todo`를 `onTap()`하게 되면 체크박스의 상태를 관리하는`bool` 타입의 변수 `isDone`의 값을 반대로 변경한다 ( `item.isDone = !item.isDone;`: 반대로 변경( fase -> true ) )
  (Update)

- 