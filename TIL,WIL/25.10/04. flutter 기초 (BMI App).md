![[Pasted image 20251017182817.png]]

- 다크, 라이트 모드 각각 구현
- 테마 상관 없이 총 2페이지의 앱을 구성
- 성별, 키, 몸무게 정보를 입력하는 HomePage
- 결과를 출력하는 ResultPage 총 2페이지 구현

**위젯 계층**

```dart
- MaterialApp
	- HomePage
		- Scaffold
			- AppBar
			- Column
				- GenderBox
				- SliderBox(키)
				- SliderBox(몸무게)
				- ElevatedButton
	- ResultPage
		- Scaffold
			- AppBar
			- Column
				- ResultGauge
				- ResultText
				- OutlinedButton
```

**프로젝트 구조 계층**
```dart
- lib
	- pages
		- home
			- home_page.dart
			- widgets // HomePage 내에서 사용할 위젯들
		- result
			- result_page.dart
			- widgets // ResultPage 내에서 사용할 위젯들
	- widgets // 앱 내에서 전체적으로 함께 사용되는 위젯들. 이번 프로젝트에서는 쓸일이 없음.
```

---

### HomePage
![[Pasted image 20251017183001.png]]
- 총 4개의 위젯 사용 예정

```dart
import 'package:flutter/material.dart';
import 'package:flutter_bmi_app/pages/home/widgets/gender_box.dart';
import 'package:flutter_bmi_app/pages/home/widgets/slider_box.dart';
import 'package:flutter_bmi_app/pages/result/result_page.dart';

class HomePage extends StatefulWidget {
  @override
  State<HomePage> createState() => _HomePageState();
}

class _HomePageState extends State<HomePage> {
  bool isMale = true;
  void onGenderChanged(bool male) {
    setState(() {
      isMale = male;
    });
  }

  double height = 175; // 기본값
  void onHeightChanged(double newHeight) {
    setState(() {
      height = newHeight;
    });
  }

  double weight = 80; // 기본값
  void onWeightChanged(double newWeight) {
    setState(() {
      weight = newWeight;
    });
  }

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(title: Text('BMI 계산기')),
      body: Padding(
        padding: const EdgeInsets.symmetric(
          horizontal: 20,
          vertical: 30,
        ), // 양 옆, 위 아래 padding을 준다
        child: Column(
          children: [
            GenderBox(isMale, onGenderChanged),
            Spacer(),
            SliderBox(
              label: '신장',
              value: height,
              unit: 'CM',
              onChanged: onHeightChanged,
            ),
            Spacer(),
            SliderBox(
              label: '체중',
              value: weight,
              unit: 'KG',
              onChanged: onWeightChanged,
            ),
            Spacer(),
            SizedBox(
              width: double.infinity, // 해당 버튼 크기 가로 최대로
              height: 50,
              child: ElevatedButton(
                onPressed: () {
                  // bmi 구하는 식
                  final meterHeight = height / 100;
                  final bmi = weight / (meterHeight * meterHeight);
                  // 계산하기 버튼 누르면 ResultPage로 이동하기
                  Navigator.push(
                    context,
                    MaterialPageRoute(
                      builder: (context) {
                        return ResultPage(bmi);
                      },
                      // 계산된 bmi값을 ResultPage에서 사용할 수 있게 전달한다. (생성자로 보낼 수 있어서 일단 비활)
                      // settings: RouteSettings(arguments: bmi),
                    ),
                  );
                },
                child: Text('계산하기'),
              ), // 배경색,그림자,입체감,그림자있는 주 액션 버튼
            ),
            SizedBox(height: 20),
          ],
        ),
      ),
    );
  }
}

```
- `ElevatedButton` 이 클릭되면 사용자가 `SliderBox`에 입력한 체중/신장을 가져와 계산 후 bmi값을 담아서 `ResultPage`로 이동
---


### gender_box.dart
```dart
import 'package:flutter/material.dart';

class GenderBox extends StatelessWidget {
  GenderBox(this.isMale, this.onChanged);

  bool isMale;
  void Function(bool newValue) onChanged;

  @override
  Widget build(BuildContext context) {
    return Row(
      children: [
        gender(context, Icons.male, '남성', isMale, true),
        SizedBox(width: 10),
        gender(context, Icons.female, '여성', !isMale, false),
      ],
    );
  }

  Widget gender(
    BuildContext context,
    IconData icon,
    String text,
    bool selected, // 클릭 여부
    bool isMaleBox, // 선택된 박스가 여자인지 남자인지 구분하기 위해 저장
  ) {
    return Expanded(
      child: GestureDetector(
        onTap: () {
          onChanged(isMaleBox);
        },
        child: Container(
          height: 150,
          decoration: BoxDecoration(
            border: Border.all(color: Theme.of(context).dividerColor),
          ),
          child: Stack(
            //
            children: [
              Positioned(
                top: 10,
                left: 10,
                // 투명도
                child: Opacity(
                  opacity: selected ? 1 : 0.3, // 0~1
                  child: Icon(icon, size: 80),
                ),
              ),
              Positioned(
                right: 20,
                bottom: 20,
                child: Opacity(
                  opacity: selected ? 1 : 0.5,
                  child: Text(
                    text,
                    style: TextStyle(fontSize: 20, fontWeight: FontWeight.bold),
                  ),
                ),
              ),
            ],
          ),
        ),
      ),
    );
  }
}

```
- 사용자의 선택 여부에 따라 `opacity` 투명도를 다르게 준다


---
### slider_box.dart
```dart
import 'package:flutter/material.dart';

class SliderBox extends StatelessWidget {
  // 3개 이상 매개변수를 받을 때는 네임드 속성으로 받는게 편함(넘겨줄때 순서 안지켜두됨)
  SliderBox({
    required this.label,
    required this.unit,
    required this.value,
    required this.onChanged,
  });

  String label;
  double value;
  String unit;
  void Function(double newValue) onChanged;

  @override
  Widget build(BuildContext context) {
    // TODO: implement build
    return Column(
      children: [
        Row(
          crossAxisAlignment: CrossAxisAlignment.end,
          children: [
            Text(label, style: TextStyle(fontSize: 15)),
            Spacer(),
            Text(
              value.toStringAsFixed(0), // 소수점 n자리까지 toString해줌
              style: TextStyle(fontSize: 20, fontWeight: FontWeight.bold),
            ),
            Text(unit, style: TextStyle(fontSize: 15)),
          ],
        ),
        Slider(value: value, onChanged: onChanged, min: 0, max: 250),
      ],
    );
  }
}
```

---
### result_gauga.dart
```dart
import 'dart:math';

import 'package:flutter/material.dart';

class ResultGauge extends StatelessWidget {
  ResultGauge(this.bmi);

  double bmi;

  @override
  Widget build(BuildContext context) {
    return Stack(
      alignment: AlignmentGeometry.center, // 전체 센터로 정렬
      children: [
        // square : 넓이, 높이 동일한 sizedBox 생성 시
        SizedBox.square(
          dimension: 250,
          child: CircularProgressIndicator(
            value: 1,
            color: Theme.of(context).dividerColor,
          ),
        ),
        SizedBox.square(
          dimension: 250,
          child: CircularProgressIndicator(
            value: min(
              bmi / 35,
              1,
            ), // (a,b)에서 a와 b중 더 작은 값을 리턴 -> bmi/35가 1보다 크면 그냥 1을 리턴
            color: Theme.of(context).highlightColor,
          ),
        ),
        Text(
          bmi.toStringAsFixed(1),
          style: TextStyle(fontSize: 30, fontWeight: FontWeight.bold),
        ),
      ],
    );
  }
}
```

- `CircularProgressIndicator` 위젯 2개를 겹쳐서 bmi 게이지를 보여주는 위젯 완성
---
### result_text.dart
```dart
import 'package:flutter/material.dart';

class ResultText extends StatelessWidget {
  ResultText(this.bmi);

  double bmi;

  String getResultText() {
    //
    if (bmi >= 35) {
      return "고도비만";
    } else if (bmi >= 30) {
      return "비만";
    } else if (bmi >= 25) {
      return "과체중";
    } else if (bmi > 18.5) {
      return "정상";
    } else {
      return "저체중";
    }
  }

  String getResultRange() {
    if (bmi >= 35) {
      return "35 이상";
    } else if (bmi >= 30) {
      return "30 ~ 35";
    } else if (bmi >= 25) {
      return "25 ~ 30";
    } else if (bmi > 18.5) {
      return "18.5 ~ 25";
    } else {
      return "18.5 미만";
    }
  }

  @override
  Widget build(BuildContext context) {
    return RichText(
      text: TextSpan(
        style: TextStyle(
          fontSize: 20,
          color: Theme.of(context).textTheme.bodyLarge?.color,
        ),
        children: [
          //
          TextSpan(text: '결과: '),
          TextSpan(
            text: getResultText(),
            style: TextStyle(
              fontWeight: FontWeight.bold,
              color: Theme.of(context).highlightColor,
            ),
          ),
          TextSpan(text: '(BMI ${getResultRange()})'),
        ],
      ),
    );
  }
}

```

- 3개 이상의 `Text` 위젯 사용시 `TextSpan` 위젯으로 사용하는게 효율적임

---

### result_page.dart
```dart
import 'package:flutter/material.dart';
import 'package:flutter_bmi_app/pages/home/home_page.dart';
import 'package:flutter_bmi_app/pages/result/widgets/result_gauge.dart';
import 'package:flutter_bmi_app/pages/result/widgets/result_text.dart';

class ResultPage extends StatelessWidget {
  ResultPage(this.bmi);

  double bmi;

  @override
  Widget build(BuildContext context) {
    // home_page.dart에서 보낸 bmi값을 받아온다 해당 값은 null이 될 수 있어서, nullable(?) 표시를 해준다. (생성자로도 받을 수 있어서 비활함)
    // final bmi = ModalRoute.of(context)?.settings.arguments;
    return Scaffold(
      appBar: AppBar(title: Text('BMI 계산기')),
      body: Padding(
        padding: const EdgeInsets.symmetric(horizontal: 20),
        child: Column(
          children: [
            Spacer(),
            ResultGauge(bmi),
            SizedBox(height: 50),
            ResultText(bmi),
            Spacer(),
            SizedBox(
              width: double.infinity,
              height: 50,
              child: OutlinedButton(
                onPressed: () {
                  Navigator.pop(
                    // 다시 homePage로 이동
                    context,
                  );
                },
                child: Text('다시 계산하기'),
              ),
            ),
            SizedBox(height: 50),
          ],
        ),
      ),
    );
  }
}

```

- `Navigator.pop` 으로 계산 다시하기 버튼 클릭 시 뒤로가게된다 (`HomePage`로)